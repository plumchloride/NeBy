# CPS
Products made in the lecture

# 機能
現在地を取得してメッセージを投稿することで、その近くの人のみに届くメッセージを残すことが出来る

# 利点
近くの人に対する集客効果やその場にいる人に対してコメントを共有することが出来る

# 詳細仕様
## 投稿に関して
140字までの短文を入力することが出来ます。改行に関しても同様に入力が可能ですが、大量の改行は迷惑行為につながるので控えてください。
## 取得に関して
付近500m四方までの投稿を取得します。=>0.01度分（約1km）
## 通信仕様（node版）
サイトに訪問した際にサーバー再度でdbから一斉にデータを取得し、ユーザの位置情報にあった投稿のみを抽出して送信しています。  
dbにメッセージが追加されるたびにそのデータをユーザに送り、ユーザサイドで自分の近くだと判別された場合にのみUIに表示する様になっています。（通信上の負荷になるため、今後の修正ポイント）
## システム構成図（node版）
|                |                                    | 
| -------------- | ---------------------------------- | 
| バックエンド   | JavaScript (Node.js)               | 
| 通信システム   | Express socket.io                  | 
| データベース   | SQLite                             | 
| フロントエンド | HTML+CSS+JavaScript (No framework) | 


# 問題点(Node版)
- データベースから過去の投稿を探す際に、すべて取得する設定になっているためデータ量が増えると重くなる
- 大量に改行を入れた迷惑投稿に対応出来ていない
- 通信の際にsocket io を通して緯度経度がまるわかり

## 通信仕様（AWS版）
データ取得ボタンを押すと投稿データを取得します  
dbにメッセージを追加する際には1回のPOSTのみを行い、他ユーザーは取得ボタンを押さないと読み込めません。  
## システム構成図（AWS版）
|                |                                    | 
| -------------- | ---------------------------------- | 
| バックエンド   | AWS lambda(Pyhton)              | 
| 通信システム   | HTTPS                  | 
| データベース   | AWS DynamoDB             | 
| フロントエンド | HTML+CSS+JavaScript (No framework) | 
# 問題点(AWS版)
- 直近10個しか取得出来ない（取得サイズやらなんやら考えた結果この値）
- 大量に改行を入れた迷惑投稿に対応出来ていない
- JavaScriptクラッキングをされた場合の不正なテキスト文字数と緯度経度に対してサーバーサイドで対応が出来ない

# 追加したい機能
- 投稿に対してクリックすると住所を表示する機能（いろいろ社会的事情てきに問題がありそう）

# 画像
<img width="576" alt="スクリーンショット 2022-06-27 11 44 34" src="https://user-images.githubusercontent.com/70005022/176003284-f97a1885-693d-417d-88c3-5f9e7345b882.png">
<img width="698" alt="スクリーンショット 2022-06-27 11 44 49" src="https://user-images.githubusercontent.com/70005022/176003328-8ead5846-3c4b-4723-ba52-7164a06ca14e.png">
